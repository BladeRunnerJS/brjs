
apply plugin: 'java'
apply plugin: com.caplin.gradle.plugins.CompileOnly

sourceSets {
	test {
		java {
			srcDirs = ["src/test/java", "src/test-integration/java"]
		}
		resources {
			srcDirs = ["src/test/resources", "src/test-integration/resources"]
		}
	}
}

configurations {
	javadocs
}

dependencies {
	compile project(":brjs-logger")
	compile dependency('commons-io')
	compile dependency('commons-lang3')
	compile dependency('guava')
	compile dependency('slf4j-api')
	compile dependency('gson')
	compile dependency('yamlbeans')
	compile dependency('validation-api')
	compile dependency('bval-jsr303')
	compile dependency('jsap')
	compile dependency('jetty-all-server')
	compile dependency('jta')
	
	compileOnly dependency('servlet-api')
	compileOnly dependency('junit')
	compileOnly dependency('mockito-core')
	compileOnly dependency('httpclient')
	compileOnly dependency('hamcrest-all')
	
	testCompile dependency('junit')
	testCompile dependency('mockito-core')
	testCompile dependency('httpclient')
	testCompile dependency('hamcrest-all')
	
	testRuntime project(path: ':brjs-logger-binding')
}

javadoc {
	title = "BladeRunnerJS ${buildVersion}"
	classpath += project.configurations.compileOnly
}

task javadocZip, type:Zip, {
	from javadoc.outputs.files.singleFile
	into "javadoc"
}

artifacts {
	javadocs javadocZip
}

task zipJsDocResources, type:Zip, dependsOn: processResources, {
	from "jsdoc-resources"
	archiveName "jsdoc-resources.zip"
	destinationDir = file("${sourceSets.main.output.resourcesDir}/org/bladerunnerjs/core/plugin/command/standard/")
}
classes.dependsOn zipJsDocResources
